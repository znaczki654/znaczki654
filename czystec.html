<pre>
  #include &lt;assert.h&gt;
  #include &lt;math.h&gt;
  #include &lt;stdlib.h&gt;
  #include &lt;stdio.h&gt;
  #include &lt;signal.h&gt;
    
  #define ROZMIAR(arr) (sizeof(arr)/sizeof(arr[0]))
  #define LICZBA_DZIECI 1
    
  int out_pipe_ids[2];
  int in_pipe_ids[2];
    
  void zadanie_dziecka() {
    for(;;) {
      int ec;
      int input;
    
      ec = read(in_pipe_ids[0], &input, sizeof(int));
      if(ec &lt; 0) {
        printf("Blad podczas czytania z potoku wejsciowego\n");
        exit(1);
      }
    
      const int wynik = obliczNajwiekszyDzielnik(input);
      printf("Najwiekszy dzielnik liczby %d to %d\n", input, wynik);
      ec = write(out_pipe_ids[1], &wynik, sizeof(int));
      if(ec &lt; 0) {
        printf("Blad podczas zapisu do potoku wyjsciowego\n");
        exit(1);
      }
    }
  }
    
  int obliczNajwiekszyDzielnik(const int n) {
    if(n &lt;= 1) {
      return 1;
    }
    
    int i;
    for(i = n/2; i &gt; 0; --i) {
      if(n % i == 0) {
        return i;
      }
    }
    assert(0);
  }
    
  int main() {  
    int ec;
    ec = pipe(out_pipe_ids);
    if(ec &lt; 0) {
      printf("Blad podczas tworzenia potokow!\n");
      exit(1);
    }
    
    ec = pipe(in_pipe_ids);
    if(ec &lt; 0) {
      printf("Blad podczas tworzenia potokow!\n");
      exit(1);
    }
    
    int liczby[] = {1, 2, 3, 4, 30, 60};
    int id_dzieci[LICZBA_DZIECI];
    int i;
    for(i = 0; i &lt; LICZBA_DZIECI; ++i) {
      const int pid = fork();
      if(pid == 0) {
        zadanie_dziecka();
      } else if(pid &gt; 0) {
        id_dzieci[i] = pid;
      } else {
        printf("Blad podczas tworzenia dzieci!\n");
        exit(1);
      }
    }
    
    // zapisz i odczytaj cala tablice
    write(in_pipe_ids[1], &liczby[0], sizeof(liczby));
    read(out_pipe_ids[0], &liczby[0], sizeof(liczby));
    
    for(i = 0; i &lt; LICZBA_DZIECI; ++i) {
      kill(id_dzieci[i], SIGTERM);
    }
    
    int wynik = 0;
    for(i = 0; i &lt; ROZMIAR(liczby); ++i) {
      wynik += liczby[i];
    }
    printf("Suma = %d\n", wynik);
    return 0;
  }
  </pre>
  